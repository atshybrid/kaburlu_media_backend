# ===============================================
# KABURLU MEDIA BACKEND - DIGITALOCEAN PRODUCTION
# ===============================================
# Copy this file to .env on your DigitalOcean App Platform
# Update values marked with <CHANGE_THIS> before deployment

# ===============================================
# DATABASE (DigitalOcean Managed PostgreSQL)
# ===============================================
DATABASE_URL=postgresql://doadmin:<DB_PASSWORD>@<DB_HOST>:25060/<DB_NAME>?sslmode=require
DATABASE_URL_DIRECT=postgresql://doadmin:<DB_PASSWORD>@<DB_HOST>:25060/<DB_NAME>?sslmode=require

# Example (replace with your actual values):
# DATABASE_URL=postgresql://doadmin:AVNS_xxxxx@kaburlutoday-do-user-xxxxx-0.m.db.ondigitalocean.com:25060/kaburlutoday?sslmode=require

# ===============================================
# SERVER
# ===============================================
PORT=8080
NODE_ENV=production
BASE_URL=https://api.yourdomain.com

# ===============================================
# CORS (Update with your frontend domains)
# ===============================================
CORS_ALLOW_ALL=false
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com,https://admin.yourdomain.com

# ===============================================
# AUTH (CHANGE THESE IN PRODUCTION!)
# ===============================================
JWT_SECRET=<GENERATE_SECURE_64_CHAR_SECRET>
JWT_REFRESH_SECRET=<GENERATE_ANOTHER_SECURE_64_CHAR_SECRET>
JWT_EXPIRES_IN=8h

# Generate secrets with: openssl rand -hex 32

# ===============================================
# APP CONFIG
# ===============================================
MULTI_TENANCY=true
ALLOW_DESTRUCTIVE=false
ALLOW_START_WITHOUT_DB=false
SKIP_SEED=true

# ===============================================
# LOGGING
# ===============================================
LOG_LEVEL=info
ENABLE_HTTP_LOGS=true
REQUEST_TIMEOUT_MS=30000
RATE_LIMIT_ENABLED=true
PRISMA_POOL_TIMEOUT=30

# ===============================================
# AI CONFIGURATION
# ===============================================
AI_PROVIDER=gemini
AI_USE_GEMINI=true
AI_USE_OPENAI=true
AI_ENABLE_SEO=true
AI_ENABLE_MODERATION=true
AI_ENABLE_TRANSLATION=true
AI_TIMEOUT_MS=120000
AI_CHECK_KEYS_ON_STARTUP=true

# Gemini (Primary)
GEMINI_API_KEY=<YOUR_GEMINI_API_KEY>
GEMINI_MODEL=gemini-2.0-flash
GEMINI_MODEL_SEO=gemini-2.0-flash
GEMINI_MODEL_REWRITE=gemini-2.0-flash
GEMINI_MODEL_MODERATION=gemini-2.0-flash
GEMINI_MODEL_TRANSLATION=gemini-2.0-flash

# OpenAI (Fallback)
OPENAI_API_KEY=<YOUR_OPENAI_API_KEY>
OPENAI_MODEL_SEO=gpt-4o
OPENAI_MODEL_NEWSPAPER=gpt-4o
OPENAI_MODEL_REWRITE=gpt-4o

# AI Prompts
AI_REWRITE_PROMPT_TRUE=ai_rewrite_prompt_true
AI_REWRITE_PROMPT_FALSE=ai_rewrite_prompt_false

# ===============================================
# FIREBASE (Push Notifications)
# ===============================================
FIREBASE_PROJECT_ID=<YOUR_FIREBASE_PROJECT_ID>
FIREBASE_CLIENT_EMAIL=<YOUR_FIREBASE_CLIENT_EMAIL>
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n<YOUR_PRIVATE_KEY>\n-----END PRIVATE KEY-----\n"

# ===============================================
# BUNNY CDN (Media Storage)
# ===============================================
MEDIA_PROVIDER=bunny
BUNNY_STORAGE_ZONE_NAME=<YOUR_STORAGE_ZONE>
BUNNY_STORAGE_API_KEY=<YOUR_BUNNY_STORAGE_API_KEY>
BUNNY_STORAGE_PUBLIC_BASE_URL=<YOUR_ZONE>.b-cdn.net
BUNNY_STREAM_LIBRARY_ID=<YOUR_STREAM_LIBRARY_ID>
BUNNY_STREAM_API_KEY=<YOUR_BUNNY_STREAM_API_KEY>

# ===============================================
# CLOUDFLARE R2 (Alternative Storage - Optional)
# ===============================================
# R2_ACCOUNT_ID=<YOUR_R2_ACCOUNT_ID>
# R2_ACCESS_KEY_ID=<YOUR_R2_ACCESS_KEY>
# R2_SECRET_ACCESS_KEY=<YOUR_R2_SECRET_KEY>
# R2_BUCKET=<YOUR_R2_BUCKET>
# R2_PUBLIC_BASE_URL=https://your-bucket.r2.dev

# ===============================================
# WHATSAPP (OTP & ID Card)
# ===============================================
WHATSAPP_PHONE_NUMBER_ID=<YOUR_PHONE_NUMBER_ID>
WHATSAPP_ACCESS_TOKEN=<YOUR_WHATSAPP_ACCESS_TOKEN>
WHATSAPP_API_VERSION=v22.0
WHATSAPP_TEMPLATE_NAME=kaburlu_app_otp
WHATSAPP_OTP_TTL_MINUTES=10
WHATSAPP_OTP_ENABLED=true
WHATSAPP_OTP_TEMPLATE_LANG=en_US
WHATSAPP_SUPPORT_MOBILE=<YOUR_SUPPORT_MOBILE>

# WhatsApp ID Card Template
WHATSAPP_IDCARD_TEMPLATE_NAME=send_idcard_reporter
WHATSAPP_IDCARD_TEMPLATE_LANG=en

# ===============================================
# MEDIA LIMITS
# ===============================================
MEDIA_MAX_IMAGE_MB=10
MEDIA_MAX_VIDEO_MB=100

# ===============================================
# SEO DEFAULTS
# ===============================================
SEO_PUBLISHER_NAME=Kaburlu
SEO_PUBLISHER_LOGO=https://your-cdn.com/logo.png
SEO_PUBLISHER_LOGO_WIDTH=600
SEO_PUBLISHER_LOGO_HEIGHT=600
SLUG_REQUIRE_UNIQUE=true

# ===============================================
# CDN IMAGE TRANSFORMS
# ===============================================
CDN_IMAGE_TRANSFORM_PROVIDER=bunny
OG_IMAGE_WIDTH=1200
OG_IMAGE_HEIGHT=630
OG_IMAGE_FORMAT=jpg
OG_IMAGE_QUALITY=85

# ===============================================
# EPAPER
# ===============================================
EPAPER_PDF_DPI=150
EPAPER_PDF_MAX_MB=100
EPAPER_PDF_MAX_PAGES=20

# ===============================================
# TENANT DEFAULTS
# ===============================================
DEFAULT_TENANT_REPORTER_ROLE_ID=<YOUR_REPORTER_ROLE_ID>

# ===============================================
# REDIS (Optional - for BullMQ job queues)
# ===============================================
# REDIS_URL=redis://default:<PASSWORD>@<HOST>:25061

# ===============================================
# DIGITALOCEAN APP PLATFORM NOTES
# ===============================================
# 1. Set these as Environment Variables in App Platform settings
# 2. For FIREBASE_PRIVATE_KEY, paste the entire key including \n
# 3. Use "Encrypt" option for sensitive values like:
#    - DATABASE_URL
#    - JWT_SECRET
#    - JWT_REFRESH_SECRET
#    - API keys (GEMINI, OPENAI, etc.)
#    - FIREBASE_PRIVATE_KEY
#    - WHATSAPP_ACCESS_TOKEN
#    - BUNNY_STORAGE_API_KEY
# 4. Build Command: npm run build
# 5. Run Command: npm start
# 6. HTTP Port: 8080
